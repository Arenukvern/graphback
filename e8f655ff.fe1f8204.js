(window.webpackJsonp=window.webpackJsonp||[]).push([[940],{1082:function(e,t,r){"use strict";r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return h}));var n=r(0),a=r.n(n);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var p=a.a.createContext({}),l=function(e){var t=a.a.useContext(p),r=t;return e&&(r="function"==typeof e?e(t):s(s({},t),e)),r},b=function(e){var t=l(e.components);return a.a.createElement(p.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},m=a.a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,o=e.originalType,c=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),b=l(r),m=n,h=b["".concat(c,".").concat(m)]||b[m]||u[m]||o;return r?a.a.createElement(h,s(s({ref:t},p),{},{components:r})):a.a.createElement(h,s({ref:t},p))}));function h(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=r.length,c=new Array(o);c[0]=m;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s.mdxType="string"==typeof e?e:n,c[1]=s;for(var p=2;p<o;p++)c[p]=r[p];return a.a.createElement.apply(null,c)}return a.a.createElement.apply(null,r)}m.displayName="MDXCreateElement"},996:function(e,t,r){"use strict";r.r(t),r.d(t,"frontMatter",(function(){return c})),r.d(t,"metadata",(function(){return s})),r.d(t,"rightToc",(function(){return i})),r.d(t,"default",(function(){return l}));var n=r(2),a=r(6),o=(r(0),r(1082)),c={id:"custom-resolvers",title:"Using Graphback in custom resolvers",sidebar_label:"Custom Resolvers"},s={unversionedId:"resolvers/custom-resolvers",id:"version-0.16.x/resolvers/custom-resolvers",isDocsHomePage:!1,title:"Using Graphback in custom resolvers",description:"The model CRUD services created by Graphback are exposed to each resolver through the context parameter. Thanks to the flexible CRUD API, you can reuse these services for various use cases in your own resolvers.",source:"@site/versioned_docs/version-0.16.x/resolvers/custom-resolvers.md",slug:"/resolvers/custom-resolvers",permalink:"/docs/resolvers/custom-resolvers",editUrl:"https://github.com/aerogear/graphback/edit/master/website/versioned_docs/version-0.16.x/resolvers/custom-resolvers.md",version:"0.16.x",sidebar_label:"Custom Resolvers",sidebar:"version-0.16.x/docs",previous:{title:"Subscriptions",permalink:"/docs/crud/subscriptions"},next:{title:"Overview",permalink:"/docs/databases/overview"}},i=[{value:"context",id:"context",children:[]},{value:"info",id:"info",children:[]}],p={rightToc:i};function l(e){var t=e.components,r=Object(a.a)(e,["components"]);return Object(o.b)("wrapper",Object(n.a)({},p,r,{components:t,mdxType:"MDXLayout"}),Object(o.b)("p",null,"The model CRUD services created by Graphback are exposed to each resolver through the ",Object(o.b)("inlineCode",{parentName:"p"},"context")," parameter. Thanks to the flexible CRUD API, you can reuse these services for various use cases in your own resolvers."),Object(o.b)("p",null,"In this example, we are going to create a custom query called ",Object(o.b)("inlineCode",{parentName:"p"},"getDraftNotes"),"."),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-typescript"}),'import { QueryFilter, GraphbackContext, buildGraphbackAPI } from "graphback";\nimport { GraphQLResolveInfo } from \'graphql\';\nimport { NoteFilter } from \'../generated-types\'; // https://graphql-code-generator.com\n\n// define your model\nconst model = `\n""" @model """\ntype Note {\n  id: ID!\n  title: String!\n}\n\n// highlight-start\ntype Query {\n  getDraftNotes: [Note]\n}\n// highlight-end\n`;\n\n// create your own custom resolvers\nconst customResolvers = {\n  Query: {\n    getDraftNotes: async (parent: any, args: any, context: GraphbackContext, info: GraphQLResolveInfo) => {\n      const filter: QueryFilter<NoteFilter> = {\n        title: {\n          startsWith: \'[DRAFT]\'\n        }\n      }\n\n      const results = await context.graphback.Note.findBy({ filter }, context, info);\n\n      return results.items;\n    }\n  }\n}\n\n// generate Graphback schema and resolvers\nconst { resolvers, typeDefs, contextCreator } = buildGraphbackAPI(model, { ... });\n\nconst apolloServer = new ApolloServer({\n  typeDefs,\n  resolvers: [resolvers, noteResolvers], // merge Graphback and custom resolvers\n  context: contextCreator\n})\n')),Object(o.b)("p",null,"See the ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"../api/graphback-core/interfaces/_runtime_graphbackcrudservice_.graphbackcrudservice"}),"GraphbackCRUDService API Reference")," for information on the methods and parameters available in the ",Object(o.b)("inlineCode",{parentName:"p"},"GraphbackCRUDService")," interface."),Object(o.b)("h3",{id:"context"},"context"),Object(o.b)("p",null,"The ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"../api/graphback-core/interfaces/_runtime_interfaces_.graphbackcontext"}),"GraphbackContext")," interface defines all CRUD services in the ",Object(o.b)("inlineCode",{parentName:"p"},"graphback")," property. Each service name matches exactly with the name of the model defined in your GraphQL schema."),Object(o.b)("p",null,"Accessing the CRUD service for the ",Object(o.b)("inlineCode",{parentName:"p"},"Note")," model:"),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-ts"}),"await context.graphback.Note.findBy(args);\n")),Object(o.b)("p",null,"Because the services and context are create at runtime the properties of ",Object(o.b)("inlineCode",{parentName:"p"},"graphback")," are dynamically typed. It is recommended that you extend ",Object(o.b)("inlineCode",{parentName:"p"},"GraphbackContext")," for your resolvers to provide strongly typed services."),Object(o.b)("p",null,"You can optionally pass the ",Object(o.b)("inlineCode",{parentName:"p"},"Note")," type generated with ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://graphql-code-generator.com/"}),"GraphQL Code Generator")," as a generic to ",Object(o.b)("inlineCode",{parentName:"p"},"GraphbackCRUDService")," for additional type-safety."),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-ts"}),"import { GraphbackContext, GraphbackCRUDService } from 'graphback';\nimport { Note } from './generated-types';\n\ninterface MyCustomContext extends GraphbackContext {\n  graphback: {\n    Note: GraphbackCRUDService<Note>\n  }\n}\n\nconst customResolvers = {\n  Query: {\n    // highlight-start\n    getDraftNotes: async (parent: any, args: any, context: MyCustomContext, info: GraphQLResolveInfo) => {\n    // highlight-end\n      ...\n    }\n  }\n}\n")),Object(o.b)("p",null,"Each ",Object(o.b)("inlineCode",{parentName:"p"},"GraphbackCRUDService")," method lets you pass the context as a parameter, as some implementations may use the context in its operations."),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-ts"}),"await context.Note.findBy(args, context);\n")),Object(o.b)("h3",{id:"info"},"info"),Object(o.b)("p",null,"The ",Object(o.b)("inlineCode",{parentName:"p"},"GraphQLResolveInfo")," object is available to every resolver and contains information about the GraphQL schema and the current operation.\nYou can optionally pass this to the ",Object(o.b)("inlineCode",{parentName:"p"},"GraphbackCRUDService")," method. A common use for this parameter is mapping the selected fields from the GraphQL query to the database query. "),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-ts"}),"await context.Note.findBy(args, context, info);\n")))}l.isMDXComponent=!0}}]);